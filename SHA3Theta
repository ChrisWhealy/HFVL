# visualization for theta in keccak f function
# input: a
Frame 1:
    $modifyTitle(text='Theta Function Visualization', color='red')
    $drawBox(description, 1120, 800, 340, 140, text='Description of events')

    $drawBox(a1,       55, 850, 1055, 90, text='A bytes')
    $drawBox(c,        55, 650,  205, 90, text='C function')
    $drawBox(d,        55, 460,  205, 90, text='D function')
    $drawBox(a2,      270, 460, 1055, 90, text='A bytes')
    $drawBox(xorLoop, 270, 260, 1055, 90, text='XOR Loop')
    $drawBox(oby,     270, 100, 1055, 90, text='Theta output')

    $drawArrow(a1,c)
    $drawArrow(c,d)
    $drawArrow(d,xorLoop)
    $drawArrow(a2,xorLoop)
    $drawArrow(xorLoop,oby)
Frame End

Frame 2:
    $modifyBox(description,color=blue,text='The A block is input to the C function D function and XOR loop')
    $modifyBox(a1,color=blue,bold=true,text=*a)
    $modifyBox(a2,color=blue,bold=true,text=*a)
Frame End

Frame 3:
    $resetBox(description)
    $resetBox(a1)
    $resetBox(a2)
Frame End

Frame 4:
    $modifyBox(description,color=blue,text='Pass the A block to the C function.')
    $modifyBox(a1,color=green,bold=true)
    $modifyArrow(a1,c,color=green)
Frame End

Frame 5:
    $modifyBox(description,color=blue,text='Click on the C function to see bit-level details.\\This function is simplified as\ for x in (0..4):\     C[x]: A[x][0] XOR A[x][1] XOR A[x][2] XOR A[x][3] XOR A[x][4]')
    $modifyBox(c,color=red,bold=true,link='SHA3ThetaC',input=a1)
Frame End

Frame 6:
    $modifyBox(c,text=@cfunc(*a))
Frame End

Frame 7:
    $resetBox(description)
    $resetBox(c)
    $resetBox(a1)
    $resetArrow(a1,c)
Frame End

Frame 8:
    $modifyBox(description,color=blue,text='Pass the C function output to the D function')
    $modifyBox(c,color=green,bold=true)
    $modifyArrow(c,d,color=green)
Frame End

Frame 9:
    $modifyBox(description,color=blue,text='Click on the D function to see bit-level details.\This function is simplified as\ for x in (0..4):\     D[x]: C[x-1] XOR ROTR(C[x+1] 1)')
    $modifyBox(d,color=red,bold=true,link='SHA3ThetaD',input=c)
Frame End

Frame 10:
    $modifyBox(d,text=@dfunc(*c))
Frame End

Frame 11:
    $resetBox(description)
    $resetBox(c)
    $resetBox(d)
    $resetArrow(c,d)
Frame End

Frame 12:
    $modifyBox(description,color=blue,text='Pass the original A block input and D function output to the XOR Loop')
    $modifyBox(d,color=green,bold=true)
    $modifyBox(a2,color=green,bold=true)
    $modifyArrow(d,xorLoop,color=green)
    $modifyArrow(a2,xorLoop,color=green)
Frame End

Frame 13:
    $modifyBox(description,color=blue,text='Click on the XOR loop box to see bit-level details.\This loop is simplified as\ for x in (0..4):\     for y in (0..4):\        A[x][y]: A[x][y] xor D[x]')
    $modifyBox(xorLoop,color=red,bold=true,link='SHA3ThetaXor',input=a2;d)
Frame End

Frame 14:
    $modifyBox(xorLoop,text=@groupAsI64(@xorloop(*a2;*d)))
Frame End

Frame 15:
    $resetBox(description)
    $resetBox(xorLoop)
    $resetBox(a2)
    $resetBox(d)
    $resetArrow(d,xorLoop)
    $resetArrow(a2,xorLoop)
Frame End

Frame 16:
    $modifyBox(description,color=blue,text='The XOR Loop output is the output of the Theta function')
    $modifyBox(xorLoop,color=blue,bold=true)
    $modifyArrow(xorLoop,oby,color=blue)
Frame End

Frame 17:
    $modifyBox(oby,color=blue,bold=true,text=*xorLoop)
Frame End

Frame 18:
    $resetBox(description)
    $resetBox(xorLoop)
    $resetArrow(xorLoop,oby)
    $modifyBox(oby,color=red)
Frame End
